package diabelli.isabelle.pure.lib
import scala.util.matching.Regex
import isabelle.Term_XML
import java.util.ArrayList

/**
 * This object provides some helper methods for converting Isabelle/Scala term
 * trees to and from the YXML format. The main purpose of these methods is to be
 * usable from Java.
 * @author Matej Urbas
 *
 */
object TermYXML {
  
  val unescapedTestTerm1: String = "5:5:00===>00=fun:00=prop:00=fun:00=prop:00=prop:5:00=HOL.Trueprop00=fun:00=HOL.bool:00=prop:5:10=Diabelli00=fun:00=Product_Type.prod:00=List.list:00=String.char:00=List.list:00=String.char:00=HOL.bool:5:5:00=Product_Type.Pair00=fun:00=List.list:00=String.char:00=fun:00=List.list:00=String.char:00=Product_Type.prod:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble800=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble700=String.nibble:00=String.nibble.Nibble900=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble700=String.nibble:00=String.nibble.Nibble000=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble500=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble700=String.nibble:00=String.nibble.Nibble200=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble200=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.NibbleC00=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.NibbleF00=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble300=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.NibbleB00=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble700=String.nibble:00=String.nibble.Nibble300=String.nibble:00=List.list.Nil00=List.list:00=String.char:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble400=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble100=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble700=String.nibble:00=String.nibble.Nibble400=String.nibble:5:5:00=List.list.Cons00=fun:00=String.char:00=fun:00=List.list:00=String.char:00=List.list:00=String.char:5:5:00=String.char.Char00=fun:00=String.nibble:00=fun:00=String.nibble:00=String.char:00=String.nibble.Nibble600=String.nibble:00=String.nibble.Nibble100=String.nibble:00=List.list.Nil00=List.list:00=String.char:5:00=HOL.Trueprop00=fun:00=HOL.bool:00=prop:5:5:00=HOL.conj00=fun:00=HOL.bool:00=fun:00=HOL.bool:00=HOL.bool:5:10=Tet00=fun:10='a:00=HOL.bool:10=a10='a:5:10=Tet00=fun:10='a:00=HOL.bool:10=b10='a";
  val escapedTestTerm1: String = "ÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0===>ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=propÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=propÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=propÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=HOL.TruepropÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=propÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ1À0=DiabelliÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=Product_Type.prodÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=Product_Type.PairÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=Product_Type.prodÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble8ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble7ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble9ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble7ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble0ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble5ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble7ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble2ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble2ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.NibbleCÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.NibbleFÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble3ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.NibbleBÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble7ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble3ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.list.NilÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble4ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble1ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble7ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble4ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=List.list.ConsÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=String.char.CharÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble6ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=String.nibble.Nibble1ÀÀÀ0À0=String.nibbleÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=List.list.NilÀÀÀ0À0=List.listÀÀÀ:ÀÀÀ0À0=String.charÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=HOL.TruepropÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=propÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ0À0=HOL.conjÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=funÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ1À0=TetÀÀÀ0À0=funÀÀÀ:ÀÀÀ1À0='aÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ1À0=aÀÀÀ1À0='aÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ5ÀÀÀ:ÀÀÀ1À0=TetÀÀÀ0À0=funÀÀÀ:ÀÀÀ1À0='aÀÀÀÀÀÀÀÀÀ:ÀÀÀ0À0=HOL.boolÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ:ÀÀÀ1À0=bÀÀÀ1À0='aÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀÀ";

  def main(args: Array[String]): Unit = {
    val unescapedYXML = unescapeControlChars(escapedTestTerm1);
    val escapedYXML = escapeControlChars(unescapedYXML);
    println(unescapedYXML);
    println(escapedTestTerm1.equals(escapedYXML));
  }
  
  /**
   * Removes the escaped control characters from the YXML string. The only escaped
   * control characters are currently "\u0005" and "\u0006", which map to
   * "\u00C0\u0085" and "\u00C0\u0086" respectively.
   */
  def unescapeControlChars(yxml: CharSequence): String = {
    if (yxml == null)
      throw new IllegalArgumentException("The YXML string must be non-null.")
    else
      (new Regex("\u00C0[\u0085\u0086]")).replaceAllIn(yxml, m => { String.valueOf((m.matched.charAt(1) - 128).asInstanceOf[Char]); })
  }
  
  /**
   * Escapes control characters in the given YXML string. The only characters
   * currently escaped are "\u0005" and "\u0006", which map to
   * "\u00C0\u0085" and "\u00C0\u0086" respectively.
   */
  def escapeControlChars(yxml: CharSequence): String = {
    if (yxml == null)
      throw new IllegalArgumentException("The YXML string must be non-null.")
    else
      (new Regex("[\u0005\u0006]")).replaceAllIn(yxml, m => { val c = (m.matched.charAt(0) + 128).asInstanceOf[Char]; String.valueOf('\u00C0')+ String.valueOf(c) })
  }
  
  /**
   * Parses the given (unescaped) YXML string and returns the corresponding term. 
   */
  def parseYXML(yxml: CharSequence): isabelle.Term.Term = {
    val t: isabelle.XML.Tree = isabelle.YXML.parse(yxml)
    isabelle.Term_XML.Decode.term(List(t))
  }
  
  /**
   * Converts the given term into a YXML string (unescaped).
   */
  def outputYXML(term: isabelle.Term.Term): CharSequence = {
    val enc = isabelle.Term_XML.Encode.term(term)
    isabelle.YXML.string_of_body(enc)
  }

}